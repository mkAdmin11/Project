# Project

## СПИСОК PLAYBOOK:

0. test.yml
1. start.yml
2. openvpn.yml
3. bind9.yml
4. postgreslq.yml
5. web.yml
6. certbot.yml
7. www.yml
8. mail.yml
9. pgadmin.yml
10. elastic.yml
11. logs.yml
12. zabbix.yml
13. grafana.yml

### Test
Не обращайте внимание, просто потестить маленькие роли)

### Start
Первоначальная настройка хостов: установка некоторых нужных в дальнейшем пакетов и обновление установленных, настройка шары и скриптов для работы через cron. Присутствовали дополнительные настроки, которые были вылезаны, такие как настрока zsh, т.к. не относятся к проекту. 

### OpenVPN
Настраивается сервер и 2 клиента. Предполагается что инфраструктура выдачи ключей имеется и готовы пары ключей для всех серверов, а также ca и dh. Использовался easy-rsa.

### Bind9
Устанавливается Bind9 на первый сервер и все сервера настраиваются на резолв через него. В Bind настрона defaul зона, а также зоны local и зона домена.

### PostgreSQL
Устанавливается PostgreSQL на сервер базы данных. Изначально по ролям из дирректории old создавались пользователи, базы, заливались схемы и данные для сервисов: WordPress, Zabbix, Rouncube, база Demo для pgAdmin и учетная запись для мониторинга состояния базы. В дальнейшем восстанавливался весь дамп кластера базы, т.к. накопились данные в основном от WordPress и Zabbix. При таком исполнении переносятся все базы, данные, схемы, а также пользователи со всеми правами. Остается только выдать права на сетевое подключение для пользователей.

### WEB
Установка nginx, Apache2, PHP и потребующиея в дальнейшем библиотеки. Первоначальная настройка: nginx - работает как прокси, Apache2 - показывает стандвртный индекс nginx. Веб сервер подготовлен для получения SSL сертификатов.

### Certbot
Установка Certbot и получение сертификатов через webroot. Настройка nginx:
+ Домен второго уровня проксирует запросы на Apache2, дополнительно проксируются запросы к сервисам которые появятся позже: Grafana на первом сервере и Kibana на третьсяем сервере. 
+ Домен третьего уровя forcustomer проксирует запросы на Apache2. 








